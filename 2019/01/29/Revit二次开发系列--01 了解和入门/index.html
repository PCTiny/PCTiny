<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Revit二次开发系列--01 了解和入门 | PCTiny</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="前言在了解何为Revit二次开发之前，我们必须先理解几个概念：  Revit软件Revit是Autodesk公司一套系列软件的名称。Revit系列软件是为建筑信息模型(BIM Building Information Modeling)构建的，可帮助建筑设计师设计、建造和维护质量更好、能效更高的建筑。  Revit APIRevit API（Application Programming Inte">
<meta property="og:type" content="article">
<meta property="og:title" content="Revit二次开发系列--01 了解和入门">
<meta property="og:url" content="http://yoursite.com/2019/01/29/Revit二次开发系列--01 了解和入门/index.html">
<meta property="og:site_name" content="PCTiny">
<meta property="og:description" content="前言在了解何为Revit二次开发之前，我们必须先理解几个概念：  Revit软件Revit是Autodesk公司一套系列软件的名称。Revit系列软件是为建筑信息模型(BIM Building Information Modeling)构建的，可帮助建筑设计师设计、建造和维护质量更好、能效更高的建筑。  Revit APIRevit API（Application Programming Inte">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2019/01/images/Revit二次开发系列--01%20了解和入门/Revit二次开发入门新建项目.png">
<meta property="og:image" content="http://yoursite.com/2019/01/images/Revit二次开发系列--01%20了解和入门/Revit二次开发添加引用.png">
<meta property="og:image" content="http://yoursite.com/2019/01/images/Revit二次开发系列--01%20了解和入门/Revit二次开发HelloWorld.png">
<meta property="og:image" content="http://yoursite.com/2019/01/images/Revit二次开发系列--01%20了解和入门/Revit二次开发HelloWorld运行.png">
<meta property="og:updated_time" content="2019-01-30T09:53:49.359Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Revit二次开发系列--01 了解和入门">
<meta name="twitter:description" content="前言在了解何为Revit二次开发之前，我们必须先理解几个概念：  Revit软件Revit是Autodesk公司一套系列软件的名称。Revit系列软件是为建筑信息模型(BIM Building Information Modeling)构建的，可帮助建筑设计师设计、建造和维护质量更好、能效更高的建筑。  Revit APIRevit API（Application Programming Inte">
<meta name="twitter:image" content="http://yoursite.com/2019/01/images/Revit二次开发系列--01%20了解和入门/Revit二次开发入门新建项目.png">
  
    <link rel="alternate" href="/atom.xml" title="PCTiny" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">PCTiny</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">一条咸鱼的个人博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Revit二次开发系列--01 了解和入门" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/29/Revit二次开发系列--01 了解和入门/" class="article-date">
  <time datetime="2019-01-29T07:27:50.689Z" itemprop="datePublished">2019-01-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Revit二次开发系列--01 了解和入门
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在了解何为Revit二次开发之前，我们必须先理解几个概念：</p>
<ul>
<li><p><strong>Revit软件</strong><br>Revit是Autodesk公司一套系列软件的名称。Revit系列软件是为建筑信息模型(BIM Building Information Modeling)构建的，可帮助建筑设计师设计、建造和维护质量更好、能效更高的建筑。</p>
</li>
<li><p><strong>Revit API</strong><br>Revit API（Application Programming Interface），是Revit为第三方开发者开放的应用程序编程接口。通过API，用户可以以编程的方式来访问和操纵Revit内部模型信息数据，还可以将自己开发的应用程序以命令或插件程序的形式集成到Revit中完成预期的工作。具体可以通过API做到哪些事情，我们后面再详细说明，这里就不再一一赘述了。</p>
</li>
<li><p><strong>Revit二次开发</strong><br>了解了RevitAPI后，我们就不难理解Revit二次开发了。运用RevitAPI以编程的方式访问Revit数据或在Revit上实现某些我们想要的功能，就是Revit二次开发。理解了上面概念，接下来就是开发需要的准备工作了。</p>
</li>
</ul>
<h2 id="必备工具"><a href="#必备工具" class="headerlink" title="必备工具"></a>必备工具</h2><p>Revit API支持任何与.NET兼容的编程语言，C#、VB.NET、C++、F#等。</p>
<ul>
<li><p><strong>Revit软件</strong><br>既然是Revit二次开发，那Revit软件自是必不可少的，可前往<a href="https://www.autodesk.com/products/revit/overview#" target="_blank" rel="noopener">Autodesk官网</a>下载各版本的Revit并安装。</p>
</li>
<li><p><strong>编程工具（VS Microsoft Visual Studio）</strong><br>VS（Microsoft Visual Studio）是美国微软公司的开发工具包系列产品，它包括了整个软件生命周期中所需要的大部分工具，如UML工具、代码管控工具、集成开发环境(IDE)等等。咱们可以用它来编写和编译自己的代码，可前往<a href="https://visualstudio.microsoft.com" target="_blank" rel="noopener">VisualStudio官网</a>下载各版本VS并安装。（<em>本Revit二次开发系列教程所用工具为：Revit 2016 + VS 2017 + C#。</em>）</p>
</li>
</ul>
<h2 id="开发入门"><a href="#开发入门" class="headerlink" title="开发入门"></a>开发入门</h2><p>在做好前期开发准备后，接下来就是实战演练了，从零开始创建一个Revit二次开发项目(Hello World)。</p>
<h3 id="Hello-World实战"><a href="#Hello-World实战" class="headerlink" title="Hello World实战"></a>Hello World实战</h3><p>创建一个名为Hello World的C#类库项目。</p>
<ul>
<li><strong>新建项目</strong></li>
</ul>
<ol>
<li>打开VS，点击 <strong><em>新建项目(Create new project…)</em></strong> 。</li>
<li>在左侧已安装的样板中选择 <strong><em>Visual C#</em></strong> 。</li>
<li>在右侧选择 <strong><em>类库(Class Library(.NET Framework))</em></strong> 项目。</li>
<li>项目名一栏填写 Hello World，项目地址一栏我的为“D:\Hello World”。</li>
<li>点击 <strong><em>确定(OK)</em></strong> 按钮。<br><img src="../../images/Revit二次开发系列--01 了解和入门/Revit二次开发入门新建项目.png" alt="新建项目"></li>
</ol>
<ul>
<li><strong>添加引用</strong></li>
</ul>
<ol>
<li>在 <strong><em>解决方案资源管理器</em></strong> 窗口中，Hello World项目下，右击 <strong><em>引用(References)</em></strong> ，点击 <strong><em>添加引用(Add Reference…)</em></strong> 。</li>
<li>在弹出的添加引用窗口中，点击 <strong><em>浏览(Browse…)</em></strong> 按钮，找到之前安装Revit的文件夹，在根目录下找到 <strong><em>RevitAPI.dll</em></strong> 和 <strong><em>RevitAPIUI.dll</em></strong>，添加并确定。例如：我的Revit安装在D盘下，则两个文件的地址为“D:\Revit2016\Revit 2016\RevitAPI.dll”和“D:\Revit2016\Revit 2016\RevitAPIUI.dll”。<br><img src="../../images/Revit二次开发系列--01 了解和入门/Revit二次开发添加引用.png" alt="新建项目"></li>
<li>添加完引用后，便可以在项目的引用下看见刚才添加的两个引用了，右击 <strong><em>RevitAPI</em></strong> 和 <strong><em>RevitAPIUI</em></strong> 两个引用，选择 <strong><em>属性(Properties)</em></strong> ，修改 <strong><em>复制本地(Copy Local)</em></strong> 值为 <strong>False</strong>（这一步目的是为了不让两个引用文件复制到生成目录中，不明白没关系，可以跳过此条）。</li>
</ol>
<ul>
<li><strong>编译程序</strong></li>
</ul>
<ol>
<li><p>添加命名空间，编写示例代码，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">using Autodesk.Revit.DB;</span><br><span class="line">using Autodesk.Revit.UI;</span><br><span class="line">using Autodesk.Revit.Attributes;</span><br><span class="line">using System;</span><br><span class="line"></span><br><span class="line">namespace Hello_World</span><br><span class="line">&#123;</span><br><span class="line">    [Transaction(TransactionMode.Manual)]</span><br><span class="line">    //实现外部命令接口</span><br><span class="line">    public class Command : IExternalCommand</span><br><span class="line">    &#123;</span><br><span class="line">        public Result Execute(ExternalCommandData commandData, </span><br><span class="line">        ref string message, ElementSet elements)</span><br><span class="line">        &#123;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                TaskDialog.Show(&quot;Hello World.&quot;, &quot;Revit二次开发&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            catch (Exception e)</span><br><span class="line">            &#123;</span><br><span class="line">                message = e.Message;</span><br><span class="line">                return Result.Failed;</span><br><span class="line">            &#125;</span><br><span class="line">            return Result.Succeeded;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>点击顶部工具栏 <strong><em>生成(Build)</em></strong> ，选择 <strong><em>生成解决方案(Build Solution)</em></strong> ，编辑器会编译刚才编写的代码，并将生成的类库文件输出到项目的Debug文件夹中。例如：我的项目在D盘Hello World文件夹下，则生成的文件路径为“D:\Hello World\Hello World\bin\Debug\Hello World.dll”。这就是我们将要在Revit中运行的命令程序，接下来我们还需要将其添加到Revit中。</p>
</li>
<li>创建清单文件（.addin）。Revit如果要调用第三方编写的应用程序，还需要创建一个清单文件将程序注册到Revit中。找到文件夹“C:\Users\Administrator\AppData\Roaming\Autodesk\Revit\Addins\2016”（这是Revit默认读取清单文件的文件夹，我使用的是Win10系统，Win7系统对应“C:\ProgramData\Autodesk\Revit\Addins\2016”），新建文件“Hello World.addin”，内容填写如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;RevitAddIns&gt;</span><br><span class="line">	&lt;AddIn Type=&quot;Command&quot;&gt;</span><br><span class="line">	&lt;VendorId&gt;Tiny&lt;/VendorId&gt;</span><br><span class="line">	&lt;Text&gt;Hello Revit&lt;/Text&gt;</span><br><span class="line">	&lt;Description&gt;Hello World to Revit.&lt;/Description&gt;</span><br><span class="line">	&lt;FullClassName&gt;Hello_World.Command&lt;/FullClassName&gt;</span><br><span class="line">	&lt;Assembly&gt;D:\Hello World\Hello World\bin\Debug\Hello World.dll&lt;/Assembly&gt;</span><br><span class="line">	&lt;AddInId&gt;E2CB270D-2889-48AD-8193-C93663BE7AD9&lt;/AddInId&gt;</span><br><span class="line">	&lt;/AddIn&gt;</span><br><span class="line">&lt;/RevitAddIns&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>【VendorId】：开发商Id，可以自己随意取名。<br>【Text】：Revit中插件的名称。<br>【Description】：插件的描述信息。（可不写这项）<br>【FullClassName】：类名。注意：得填写完整的 <strong><em>命名空间.类名</em></strong> 。<br>【Assembly】：需要加载的程序集的完整路径，即上面创建的类库文件的路径。<br>【AddInId】：这一项在VS的 <strong><em>工具</em></strong> → <strong><em>创建GUID</em></strong> 中获得。</p>
<ul>
<li><strong>运行程序</strong></li>
</ul>
<ol>
<li>打开Revit软件，选择 <strong><em>附件模块</em></strong> → <strong><em>外部工具</em></strong>，就可以看见创建的Hello World应用程序了。<br><img src="../../images/Revit二次开发系列--01 了解和入门/Revit二次开发HelloWorld.png" alt="新建项目"></li>
<li>点击 <strong><em>Hello World</em></strong> 就可以运行了。<br><img src="../../images/Revit二次开发系列--01 了解和入门/Revit二次开发HelloWorld运行.png" alt="运行Hello World"></li>
</ol>
<h2 id="后序"><a href="#后序" class="headerlink" title="后序"></a>后序</h2><p>一直想做一个Revit二次开发的系列教程，一为总结，二为分享。但是，由于个人时间问题一直搁置到现在，后续我会不定期更新这个系列教程。</p>
<p><strong><em>内容或有偏颇之处，欢迎批评和指正，不胜感激！</em></strong><br><strong><em>文章皆为个人原创，转载还请注明出处！</em></strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/29/Revit二次开发系列--01 了解和入门/" data-id="cjrj0nlgz0000h0pvsus26blm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/01/29/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/01/29/Revit二次开发系列--01 了解和入门/">Revit二次开发系列--01 了解和入门</a>
          </li>
        
          <li>
            <a href="/2019/01/29/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 PCTiny<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>